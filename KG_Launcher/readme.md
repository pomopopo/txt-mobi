# KG_Launcher 说明

## 〇、干什么的

 - 这个是 kindlegen 的加载器（壳）
 - 用来把 epub/htm/html/opf/zip/目录 转换成 mobi
    - mobi 是放在 kindle 里读的电子书，不做 mobi 的人也用不到这个软件
     - 实质上是调用了亚马逊的 kindlegen.exe

## 一、怎么操作

 - 拖被转换的文件到程序图标，或者
 - 打开程序后，拖文件到窗口任意地方
 - 支持多文件拖拽，但是排队逐个处理
 - 生成的 mobi 和原文件同目录、同文件名、不同扩展名
 - 如果有相同的 .mobi 会被自动覆盖，**无提示**！
 - 不打开程序，直接拖文件到图标上，工作方式取决于上次运行后的设置（因为会读取）。如果是第一次运行就按默认参数：高压缩比，详细信息。
 - 一次性拽文件数量受系统最大路径长度限制，具体多少个文件，取决于“路径+文件名”的总长度。所以**可能**是个不确定的数字，但至少要有4k-8k的样子？折算成文件，几十个是可以的（猜的）
 - 可以设的参数有：
    - 压缩方式（大/中/小）。亚马逊为了速度与压缩后文件大小平衡，默认是 standard，但我为了大压缩比才做的这个壳，所以我要用 Huffdic（慢很多，但是能小1/3）。
    - 转换信息详细程度。选什么影响都不大。详细的好处是知道哪里没做好，可以决定是不是要返工修改源文件。
    - 使用1252字符集。西文字符集，纯外语的文件才要用，中文的就别用了。
    - 使用GIF。要保留锐利细节的图片才用这个，就是 Jpg 有损压缩的锅。
    - 不包含源文件。文件能缩小1/3，但不符合官方标准。亚马逊要求带源文件，没有的话用 kindle previewer 打开时会提示，但真要是通过邮件推送，源文件和V7格式的又会去掉。（更多细节没研究过）

## 二、运行状态保存

 - 内容存在 “可执行文件名.cfg” 里，可编辑的文本文件。
 - 只保存了上按钮状态，窗口位置/大小/内容不保存。
 - 程序打开时读状态，程序关闭时保存状态。
 - 把 .cfg 文件删了，就可以回到初始状态。

## 三、语言

- 随系统
- 设定显示其他语言界面没地方放，不做了

## 四、文件位置

 - kindlegen.exe 一定要放在 ./kindlegen/ 下面，放其他地方不工作。
 - 暂时也没考虑到路径/注册表/常见位置里找 kindlegen.exe 的功能，似乎不急。（因为就我自己在用）

## n、其他

有大神（***秦始皇 512871306***）QQ上说：

```bat
@echo off
color 2e
kindlegen %1 -c1 -verbose -dont_append_source -o %~n1.mobi
echo.
echo 操作完成，10秒后关闭...
ping 127.0.0.1 -n 10 > nul
```

>放到 “发送到”，就直接可以批处理解决了！用不上这么复杂的程序……

 其实，对我更重要的是：

**做这个壳，漂亮啊！可以直观选择参数，可以批量处理，可以看到执行结果，还可以知道大致进度...**

## 还有咩?

 - 不写bug是不可能的，这辈子都不可能的。
    - 很大的文件拖到图标上，界面不出来。
    - 有的epub太简洁了，以至于转换不成功（亚马逊的问题）
 - 2019-6-25 第一稿终于瞎编出来了



Po

2019-06